[p2p]
# DHT and P2P Configuration
dht_port = 30609
dht_bootstrap_nodes = 159.65.253.245:30609, 167.86.116.185:30609, router.utorrent.com:6881, router.bittorrent.com:6881, dht.transmissionbt.com:6881, dht.aelitis.com:6881, router.silotis.us:6881, dht.libtorrent.org:25401, dht.anacrolix.link:42069, router.bittorrent.cloud:42069

# QUIC Configuration
quic_port = 30906
quic_listen_addr = 0.0.0.0
quic_connection_timeout = 5m
quic_keepalive_period = 15s
quic_stream_timeout = 10s
quic_stream_open_timeout = 5s
quic_max_connections = 100

# Peer Discovery
peer_discovery_interval = 30s
peer_maintenance_interval = 5m
max_peers_per_topic = 50

# Peer Metadata Aging and Reachability
peer_metadata_max_age = 24h
peer_reachability_check_interval = 5m

[topics]
# Topics to subscribe to (comma-separated)
subscribe_topics = remote-network-mesh
# Topic announcement interval
topic_announce_interval = 60s
# Topic refresh interval
topic_refresh_interval = 5m

[network]
# Network timeouts and limits
connection_timeout = 10s
stream_read_timeout = 30s
stream_write_timeout = 10s
max_message_size = 1048576
buffer_size = 65536

[log]
# Logging Configuration
logfile = remote-network
log_level = debug
log_max_size_mb = 100
log_max_age_days = 30
log_max_backups = 10
log_rotation_interval = daily
log_enable_rotation = true

[misc]
# Miscellaneous settings
node_name = remote-network-node
pid_path = ./remote-network.pid

[database]
# Database configuration
database_file = remote-network.db

[nat]
# NAT Detection and Classification
nat_stun_servers = stun.l.google.com:19302, stun1.l.google.com:19302, stun2.l.google.com:19302
nat_stun_timeout = 5s
nat_stun_buffer_size = 1024
nat_test_hairpinning = true
nat_default_filtering = address-port-dependent
nat_port_prediction_samples = 3
nat_port_prediction_max_diff = 10
nat_hairpinning_timeout = 2s
nat_detection_interval = 300s

[relay]
# Relay Service Configuration
relay_mode = false
relay_auto_select = true
relay_max_connections = 100
relay_connection_keepalive = 30s
relay_keepalive_interval = 5s
relay_discovery_interval = 60s
relay_pricing_per_gb = 0.001
relay_free_coordination = true
relay_max_coordination_msg_size = 10240
relay_batch_interval = 30s
relay_traffic_batch_size = 100
relay_max_circuit_age = 3600s

# Relay Selection (for NAT peers)
relay_max_latency = 500ms
relay_min_reputation = 0.3
relay_initial_reputation = 0.5
relay_max_pricing = 0.01
relay_switch_threshold = 0.2
relay_evaluation_interval = 5m

[hole_punch]
# Hole Punching / NAT Traversal Configuration
hole_punch_enabled = true
hole_punch_timeout = 10s
hole_punch_stream_timeout = 60s
hole_punch_direct_dial_timeout = 5s
hole_punch_max_attempts = 3
hole_punch_retry_interval = 200ms

# LAN Detection
hole_punch_lan_detection_enabled = true
hole_punch_lan_subnet_mask = 24

# Metrics
hole_punch_metrics_enabled = true

[metadata_broadcast]
# Metadata Broadcast Configuration
metadata_broadcast_enabled = true

# Broadcast behavior
metadata_broadcast_batch_interval = 5s
metadata_broadcast_max_batch_size = 50
metadata_broadcast_ttl = 3

# Delivery
metadata_broadcast_timeout = 10s
metadata_broadcast_max_retries = 3
metadata_broadcast_retry_interval = 30s

# Deduplication
metadata_broadcast_dedupe_window = 5m

# Hole punching for broadcasts
metadata_broadcast_hole_punch_enabled = true
metadata_broadcast_hole_punch_timeout = 10s

[peer_exchange]
# Peer Exchange Protocol Configuration
# Enables sharing of known peer lists during metadata exchanges

# Peer selection thresholds
# Minimum peers to exchange (send all if below this)
peer_exchange_min = 20
# Maximum peers to exchange (use smart selection if above)
peer_exchange_max = 20
# Maximum age of peers to share in seconds (2 hours default)
peer_exchange_max_age_seconds = 7200

# Smart selection is used when peer count > peer_exchange_min
# Selection strategy:
# - Relays: 25% (critical infrastructure, high priority)
# - NAT with relay: 40% (reachable peers, helps NAT-NAT discovery)
# - Public peers: 20% (directly reachable)
# - Others: 15% (variety and network diversity)
#
# Scoring factors:
# - Relay nodes: 5x multiplier
# - NAT peers with relay: 3x multiplier
# - Public non-relay peers: 2x multiplier
# - Fresh peers (<5min): 2x multiplier
# - Different relay cluster: 1.5x multiplier
# - Different subnet: 1.3x multiplier
# - Same LAN: 0.5x penalty